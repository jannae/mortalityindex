<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <style>
    .county {
        fill: #FF1E00;
        stroke: #FF1E00;
    }
    .bounds {
        fill: none;
        stroke: #FF0;
        stroke-dasharray: 2, 2;
        stroke-linejoin: round;
    }
    .states {
        fill: none;
        stroke: #fff;
        stroke-linejoin: round;
    }
    </style>
    <script type="text/javascript" src="_libs/jquery-2.0.3.js"></script>
    <script type="text/javascript" src="_libs/d3.v3.js"></script>
    <script type="text/javascript" src="_libs/topojson.v1.js"></script>
    <script type="text/javascript" src="_js/utils.js"></script>
</head>

<body>
    <div id="main"></div>

    <script>
    var width = window.innerWidth,
        height = window.innerHeight;

    var svg = d3.select("#main").append("svg")
        .attr("width", width)
        .attr("height", height);

    d3.json("_data/us.json", function(error, us) {
        var counties = topojson.feature(us, us.objects.counties);
        var projection = d3.geo.albers()
            .scale(width)
            .translate([width / 2, height / 2]);
        var path = d3.geo.path()
            .projection(projection);

        svg.append("path")
            .datum(counties)
            .attr("d", path);

        svg.selectAll(".county")
            .data(counties.features)
            .enter().append("path")
            .attr("class", function(d) {
                return "county " + d.id;
            })
            .attr("d", path);

        svg.append("path")
            .datum(topojson.mesh(us, us.objects.counties, function(a, b) {
                return a !== b;
            }))
            .attr("d", path)
            .attr("class", "bounds");

        svg.append("path")
            .datum(topojson.mesh(us, us.objects.states, function(a, b) {
                return a.id !== b.id;
            }))
            .attr("class", "states")
            .attr("d", path);
    });
    </script>
</body>

</html>
